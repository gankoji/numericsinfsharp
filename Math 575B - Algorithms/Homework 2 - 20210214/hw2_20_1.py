import numpy as np
import matplotlib.pyplot as plt
import scipy.optimize as opt
import math

imageInput = np.array([[255, 209, 195, 202, 165, 255, 227, 255, 181, 169, 249, 180, 228, 190, 192, 255, 218, 150, 139, 198, 247, 197, 183, 224, 191, 196, 154, 239, 192, 119, 238, 247, 255, 255, 255, 115, 152, 204, 166, 142, 201, 230, 250, 232, 193, 142, 205, 73, 192, 202, 105, 181, 207, 131, 239, 241, 241, 216, 230, 206, 121, 255, 255, 187],
[255, 200, 236, 244, 255, 213, 254, 139, 255, 202, 140, 255, 209, 216, 255, 255, 128, 170, 245, 166, 219, 242, 155, 190, 255, 213, 126, 245, 167, 186, 255, 225, 255, 182, 163, 215, 103, 219, 141, 121, 238, 129, 250, 255, 194, 190, 151, 204, 149, 226, 205, 245, 183, 122, 211, 136, 216, 179, 209, 237, 133, 160, 121, 249],
[98, 196, 206, 169, 250, 255, 211, 225, 188, 232, 232, 242, 231, 145, 183, 221, 105, 210, 148, 245, 133, 207, 216, 218, 191, 216, 255, 161, 156, 88, 255, 247, 159, 255, 198, 140, 114, 201, 146, 107, 255, 235, 209, 101, 255, 234, 250, 255, 215, 255, 185, 214, 255, 173, 214, 208, 200, 145, 111, 202, 190, 109, 255, 142],
[173, 255, 221, 195, 180, 255, 234, 212, 156, 214, 255, 208, 191, 235, 239, 246, 255, 221, 171, 196, 121, 255, 233, 244, 251, 207, 179, 168, 255, 255, 255, 241, 205, 147, 219, 229, 252, 239, 202, 77, 255, 225, 234, 162, 232, 159, 163, 178, 198, 255, 209, 251, 255, 255, 118, 242, 255, 225, 243, 255, 232, 250, 198, 166],
[162, 209, 236, 223, 163, 156, 248, 149, 250, 177, 178, 108, 134, 123, 215, 138, 204, 185, 255, 150, 215, 133, 143, 172, 231, 135, 219, 140, 159, 162, 164, 179, 75, 255, 226, 65, 192, 180, 220, 214, 209, 255, 255, 201, 210, 189, 158, 178, 188, 255, 207, 126, 182, 126, 223, 152, 212, 168, 161, 241, 245, 162, 220, 207],
[161, 255, 227, 255, 185, 194, 238, 179, 214, 82, 198, 138, 139, 255, 243, 215, 186, 255, 171, 212, 211, 187, 113, 71, 251, 242, 165, 187, 242, 255, 255, 138, 225, 182, 255, 255, 194, 234, 195, 157, 248, 187, 141, 163, 172, 219, 239, 139, 197, 174, 255, 251, 203, 199, 181, 214, 255, 150, 191, 156, 190, 182, 226, 255],
[204, 255, 182, 227, 204, 150, 255, 154, 220, 181, 213, 245, 208, 194, 255, 242, 255, 162, 255, 210, 255, 173, 191, 159, 156, 233, 117, 194, 190, 255, 236, 192, 211, 231, 112, 182, 203, 214, 196, 238, 250, 254, 226, 233, 255, 215, 255, 197, 255, 153, 240, 117, 132, 185, 110, 198, 196, 180, 255, 255, 245, 94, 227, 144],
[179, 196, 193, 202, 234, 125, 138, 245, 199, 197, 224, 255, 102, 74, 224, 203, 231, 162, 221, 216, 137, 217, 181, 214, 140, 204, 255, 255, 168, 230, 179, 179, 225, 213, 246, 224, 173, 212, 146, 130, 172, 255, 255, 185, 232, 213, 194, 183, 215, 186, 123, 217, 227, 226, 202, 162, 172, 167, 239, 160, 184, 255, 215, 128],
[255, 227, 255, 250, 235, 221, 205, 129, 255, 168, 255, 174, 141, 136, 216, 216, 202, 222, 192, 255, 165, 175, 104, 168, 255, 167, 200, 165, 174, 255, 182, 255, 98, 254, 245, 162, 190, 255, 83, 229, 246, 235, 255, 179, 204, 248, 169, 255, 255, 193, 177, 97, 255, 119, 193, 178, 128, 212, 255, 138, 218, 208, 155, 163],
[230, 246, 176, 234, 139, 206, 223, 255, 236, 230, 195, 161, 224, 191, 151, 172, 255, 165, 165, 255, 255, 186, 99, 255, 161, 23, 121, 86, 0, 63, 135, 70, 77, 0, 56, 0, 42, 65, 84, 236, 207, 191, 141, 234, 208, 255, 194, 98, 119, 255, 255, 121, 216, 255, 160, 145, 147, 251, 255, 218, 180, 175, 255, 203],
[222, 255, 220, 168, 231, 189, 183, 206, 106, 108, 255, 159, 162, 255, 205, 180, 245, 201, 199, 192, 199, 251, 216, 200, 94, 0, 14, 27, 14, 57, 0, 60, 105, 35, 102, 16, 56, 13, 21, 180, 237, 162, 176, 222, 88, 200, 255, 192, 195, 217, 255, 210, 228, 217, 235, 177, 151, 180, 192, 255, 234, 170, 209, 255],
[122, 114, 137, 207, 255, 95, 85, 227, 190, 138, 168, 219, 255, 255, 174, 172, 164, 222, 141, 193, 207, 242, 195, 173, 40, 18, 41, 0, 51, 104, 77, 0, 0, 93, 0, 153, 105, 59, 0, 67, 193, 130, 249, 145, 190, 255, 255, 166, 255, 106, 217, 234, 255, 178, 242, 142, 224, 163, 171, 210, 211, 230, 164, 214],
[152, 126, 129, 205, 182, 214, 199, 167, 168, 252, 206, 255, 174, 138, 164, 184, 198, 255, 145, 241, 142, 255, 255, 91, 22, 6, 24, 119, 48, 6, 52, 33, 0, 42, 104, 0, 143, 19, 63, 56, 203, 252, 234, 235, 210, 105, 192, 109, 168, 201, 220, 118, 220, 205, 202, 196, 220, 163, 255, 255, 214, 61, 255, 255],
[174, 219, 166, 146, 242, 129, 236, 148, 226, 213, 236, 162, 192, 159, 186, 221, 210, 211, 221, 156, 255, 180, 252, 35, 92, 155, 134, 66, 104, 51, 108, 141, 112, 62, 0, 39, 87, 2, 80, 150, 158, 250, 255, 245, 178, 184, 164, 138, 199, 213, 153, 104, 196, 164, 162, 181, 220, 187, 146, 146, 253, 177, 100, 205],
[196, 243, 158, 228, 192, 234, 189, 201, 255, 201, 211, 244, 235, 152, 255, 255, 169, 255, 218, 198, 167, 148, 127, 57, 13, 0, 144, 39, 28, 158, 81, 32, 29, 0, 31, 21, 49, 36, 59, 117, 149, 228, 183, 164, 241, 150, 243, 153, 176, 255, 242, 207, 255, 211, 186, 162, 203, 124, 251, 160, 130, 152, 132, 176],
[109, 163, 179, 255, 226, 255, 97, 163, 129, 203, 201, 239, 255, 207, 126, 192, 184, 255, 216, 216, 170, 207, 177, 20, 113, 44, 81, 0, 0, 0, 25, 204, 60, 147, 69, 76, 41, 16, 20, 108, 37, 229, 219, 255, 213, 255, 219, 195, 255, 142, 213, 194, 255, 250, 122, 255, 158, 152, 118, 191, 179, 250, 255, 135],
[255, 190, 146, 248, 255, 234, 255, 220, 170, 176, 236, 140, 85, 255, 229, 170, 255, 205, 255, 148, 255, 142, 0, 77, 59, 41, 35, 2, 17, 0, 126, 32, 20, 39, 92, 51, 95, 75, 105, 140, 63, 75, 248, 190, 147, 130, 144, 178, 116, 212, 175, 173, 255, 200, 255, 255, 231, 238, 195, 248, 220, 172, 213, 152],
[204, 176, 144, 239, 218, 255, 154, 164, 186, 222, 132, 250, 255, 140, 83, 214, 238, 166, 80, 201, 240, 72, 82, 37, 26, 67, 0, 26, 14, 121, 17, 25, 23, 35, 90, 87, 83, 70, 123, 79, 129, 113, 255, 212, 232, 242, 193, 159, 169, 199, 236, 199, 210, 138, 254, 242, 255, 105, 255, 232, 130, 219, 164, 255],
[223, 179, 248, 219, 209, 237, 223, 155, 213, 197, 153, 101, 249, 255, 211, 183, 245, 178, 186, 212, 235, 237, 80, 64, 54, 87, 77, 77, 10, 13, 30, 121, 0, 19, 0, 81, 99, 38, 122, 86, 88, 18, 81, 240, 195, 101, 167, 213, 214, 178, 255, 226, 141, 224, 125, 246, 255, 172, 255, 122, 170, 137, 160, 172],
[255, 255, 212, 244, 78, 205, 83, 255, 206, 136, 184, 163, 203, 255, 255, 122, 223, 113, 122, 170, 139, 149, 22, 51, 0, 120, 115, 56, 14, 21, 121, 0, 162, 46, 77, 67, 28, 0, 11, 36, 100, 61, 106, 129, 146, 162, 242, 255, 227, 201, 173, 237, 226, 119, 193, 246, 169, 239, 255, 184, 120, 196, 163, 248],
[247, 214, 200, 231, 114, 167, 255, 247, 212, 255, 226, 234, 175, 235, 247, 232, 255, 222, 176, 162, 139, 92, 26, 0, 37, 1, 0, 58, 26, 66, 32, 169, 186, 16, 89, 25, 48, 0, 15, 18, 38, 52, 58, 187, 203, 255, 139, 255, 184, 252, 199, 229, 183, 164, 169, 248, 162, 255, 255, 118, 225, 213, 208, 205],
[184, 204, 119, 201, 255, 216, 204, 149, 207, 177, 188, 176, 225, 249, 216, 164, 187, 195, 165, 145, 130, 119, 40, 101, 66, 86, 75, 114, 36, 140, 96, 170, 162, 0, 61, 29, 90, 107, 58, 6, 0, 42, 91, 198, 229, 190, 235, 176, 255, 255, 224, 248, 216, 255, 205, 212, 127, 252, 60, 187, 250, 182, 249, 246],
[227, 182, 182, 188, 202, 255, 255, 169, 235, 189, 213, 215, 110, 194, 255, 255, 191, 136, 127, 94, 103, 47, 56, 72, 16, 22, 23, 0, 51, 31, 89, 203, 167, 27, 0, 53, 135, 49, 29, 16, 135, 2, 42, 125, 203, 255, 146, 145, 245, 164, 255, 241, 153, 202, 130, 171, 196, 195, 205, 167, 246, 255, 115, 193],
[255, 233, 138, 248, 221, 184, 251, 151, 239, 231, 247, 222, 154, 214, 255, 255, 255, 255, 235, 248, 88, 7, 69, 0, 12, 39, 0, 0, 8, 0, 198, 231, 104, 0, 2, 38, 137, 149, 61, 34, 32, 44, 0, 0, 255, 170, 226, 255, 244, 231, 194, 184, 132, 115, 210, 233, 255, 230, 222, 236, 238, 180, 132, 192],
[224, 191, 255, 255, 158, 133, 74, 185, 255, 171, 245, 162, 228, 234, 230, 255, 107, 168, 222, 48, 17, 111, 14, 40, 106, 19, 63, 0, 0, 1, 224, 214, 255, 233, 24, 137, 27, 126, 111, 50, 0, 99, 30, 82, 108, 172, 255, 104, 172, 196, 76, 214, 211, 255, 171, 223, 204, 255, 126, 181, 213, 98, 244, 193],
[143, 243, 186, 165, 255, 145, 214, 242, 173, 223, 180, 187, 248, 122, 254, 170, 165, 184, 56, 62, 32, 109, 82, 50, 10, 80, 148, 94, 54, 61, 228, 250, 195, 190, 52, 75, 32, 57, 21, 55, 0, 104, 49, 102, 86, 255, 127, 255, 219, 199, 255, 255, 253, 77, 159, 237, 242, 164, 173, 216, 149, 174, 255, 255],
[118, 162, 241, 175, 204, 155, 208, 231, 220, 226, 255, 150, 174, 138, 220, 235, 147, 215, 78, 8, 25, 43, 109, 110, 2, 119, 17, 71, 81, 186, 113, 246, 103, 240, 91, 85, 48, 0, 0, 0, 80, 105, 18, 0, 56, 222, 236, 169, 255, 217, 134, 132, 223, 130, 199, 164, 200, 206, 238, 133, 193, 152, 255, 112],
[123, 205, 169, 233, 209, 255, 247, 185, 189, 255, 129, 255, 206, 211, 235, 255, 167, 191, 133, 60, 118, 18, 46, 112, 109, 31, 85, 93, 0, 189, 255, 153, 255, 230, 105, 0, 28, 62, 43, 46, 38, 24, 63, 89, 85, 105, 237, 176, 171, 242, 213, 166, 223, 255, 135, 255, 214, 255, 239, 154, 231, 184, 170, 183],
[239, 255, 218, 169, 97, 254, 184, 178, 242, 172, 213, 126, 192, 188, 128, 255, 255, 142, 18, 9, 105, 78, 60, 86, 40, 36, 0, 84, 176, 105, 215, 255, 149, 183, 118, 53, 0, 31, 58, 4, 55, 73, 67, 57, 113, 143, 185, 233, 255, 231, 234, 238, 239, 251, 212, 201, 168, 255, 140, 239, 112, 99, 196, 255],
[246, 230, 251, 224, 184, 179, 212, 223, 238, 254, 168, 184, 174, 117, 125, 161, 208, 64, 16, 39, 7, 73, 33, 164, 80, 32, 19, 36, 105, 255, 155, 255, 181, 255, 188, 60, 132, 35, 48, 66, 4, 15, 90, 121, 28, 45, 170, 185, 197, 184, 189, 205, 95, 237, 255, 142, 255, 227, 223, 255, 238, 154, 191, 163],
[250, 237, 255, 255, 146, 255, 203, 192, 255, 173, 255, 207, 196, 211, 63, 186, 170, 57, 116, 67, 32, 18, 52, 0, 56, 0, 132, 33, 161, 135, 193, 236, 230, 235, 244, 114, 17, 15, 40, 62, 43, 0, 29, 5, 77, 5, 80, 146, 214, 170, 176, 248, 240, 173, 155, 122, 220, 142, 218, 198, 235, 203, 255, 187],
[160, 151, 236, 208, 241, 255, 255, 249, 190, 134, 149, 205, 125, 124, 228, 236, 223, 25, 39, 25, 42, 0, 43, 77, 0, 0, 4, 13, 210, 195, 182, 255, 107, 152, 155, 194, 17, 45, 9, 64, 135, 37, 0, 17, 108, 2, 61, 217, 202, 173, 182, 183, 255, 121, 186, 255, 255, 111, 162, 130, 222, 255, 219, 255],
[236, 191, 243, 200, 232, 252, 179, 116, 255, 236, 255, 181, 226, 254, 134, 231, 145, 111, 30, 0, 95, 125, 127, 66, 0, 11, 33, 141, 245, 237, 153, 252, 175, 255, 141, 165, 0, 71, 104, 86, 28, 93, 26, 0, 0, 28, 76, 153, 176, 255, 181, 234, 199, 162, 233, 217, 155, 117, 180, 140, 206, 255, 193, 255],
[255, 150, 119, 218, 181, 144, 138, 127, 178, 255, 255, 205, 140, 255, 220, 121, 26, 45, 90, 0, 45, 77, 136, 79, 0, 0, 29, 190, 229, 239, 170, 203, 255, 232, 167, 164, 89, 54, 111, 27, 174, 67, 0, 0, 0, 24, 125, 80, 229, 255, 211, 255, 178, 234, 174, 70, 179, 197, 167, 203, 210, 212, 148, 171],
[217, 234, 182, 192, 255, 208, 255, 199, 75, 221, 233, 197, 215, 202, 117, 168, 94, 0, 47, 71, 24, 49, 54, 0, 62, 103, 88, 219, 225, 148, 245, 189, 255, 92, 203, 255, 255, 18, 112, 47, 14, 60, 80, 12, 50, 38, 0, 142, 244, 223, 164, 163, 191, 173, 255, 178, 227, 116, 189, 132, 205, 229, 144, 240],
[172, 207, 255, 204, 151, 178, 241, 233, 119, 178, 222, 182, 214, 255, 123, 64, 19, 89, 23, 53, 171, 90, 29, 134, 0, 61, 216, 185, 245, 255, 207, 199, 238, 255, 102, 157, 212, 16, 84, 110, 68, 72, 42, 71, 121, 149, 65, 21, 115, 186, 210, 158, 190, 197, 255, 229, 255, 162, 231, 221, 196, 191, 174, 255],
[229, 186, 221, 159, 158, 177, 191, 207, 191, 222, 148, 222, 143, 167, 124, 39, 53, 118, 85, 51, 47, 61, 26, 96, 0, 72, 238, 142, 239, 199, 221, 230, 207, 222, 227, 233, 235, 75, 169, 26, 24, 74, 84, 69, 47, 39, 21, 49, 74, 197, 206, 210, 189, 195, 150, 183, 189, 255, 211, 239, 211, 255, 205, 223],
[196, 216, 225, 155, 193, 230, 250, 197, 239, 233, 255, 241, 188, 247, 69, 75, 111, 89, 6, 0, 78, 23, 138, 7, 82, 179, 168, 200, 222, 221, 183, 209, 206, 219, 164, 193, 255, 122, 52, 24, 63, 14, 94, 85, 36, 97, 89, 72, 92, 201, 235, 244, 174, 218, 179, 177, 204, 202, 255, 140, 199, 225, 179, 168],
[255, 215, 154, 188, 208, 100, 215, 255, 255, 162, 222, 191, 165, 151, 81, 34, 37, 0, 37, 90, 30, 124, 0, 100, 105, 103, 255, 153, 204, 255, 112, 185, 164, 176, 255, 148, 206, 249, 132, 16, 139, 21, 50, 25, 68, 28, 119, 93, 0, 126, 215, 198, 210, 130, 240, 89, 98, 137, 207, 207, 207, 126, 214, 145],
[200, 176, 12, 177, 186, 177, 209, 255, 255, 164, 172, 228, 191, 119, 35, 79, 0, 42, 106, 6, 60, 4, 59, 157, 133, 72, 15, 39, 56, 0, 28, 49, 90, 0, 60, 21, 94, 37, 47, 18, 28, 67, 76, 29, 67, 74, 28, 36, 0, 55, 66, 243, 192, 255, 255, 58, 158, 146, 181, 98, 167, 240, 62, 195],
[224, 245, 198, 189, 243, 196, 187, 255, 143, 192, 175, 125, 81, 0, 43, 69, 28, 95, 63, 31, 116, 9, 91, 110, 0, 5, 37, 69, 135, 102, 110, 3, 70, 27, 64, 119, 0, 62, 82, 60, 81, 37, 79, 125, 175, 58, 19, 141, 134, 82, 124, 255, 255, 255, 234, 145, 127, 205, 247, 209, 214, 214, 245, 120],
[219, 235, 221, 255, 205, 178, 217, 242, 255, 158, 245, 180, 122, 32, 53, 52, 103, 0, 78, 79, 83, 0, 138, 97, 86, 41, 0, 104, 154, 76, 0, 47, 0, 88, 53, 55, 14, 84, 65, 112, 27, 106, 190, 59, 0, 27, 90, 0, 23, 117, 185, 217, 243, 196, 255, 172, 185, 205, 254, 255, 211, 250, 110, 176],
[168, 137, 135, 157, 253, 197, 238, 191, 178, 131, 139, 195, 217, 74, 0, 0, 136, 25, 48, 34, 78, 29, 0, 34, 138, 23, 34, 50, 47, 0, 0, 56, 5, 43, 0, 135, 66, 52, 22, 48, 108, 65, 0, 0, 111, 0, 0, 37, 21, 0, 118, 154, 139, 196, 231, 191, 136, 176, 141, 135, 255, 155, 174, 225],
[205, 189, 113, 169, 255, 136, 206, 193, 171, 164, 233, 159, 72, 47, 53, 52, 111, 97, 11, 63, 37, 26, 55, 96, 68, 40, 82, 6, 69, 78, 2, 70, 76, 6, 38, 20, 123, 165, 85, 51, 30, 23, 35, 110, 64, 121, 90, 99, 43, 71, 0, 202, 251, 224, 239, 186, 203, 218, 179, 245, 184, 255, 246, 186],
[184, 151, 172, 255, 135, 219, 184, 176, 210, 192, 233, 161, 44, 57, 198, 26, 0, 45, 54, 1, 0, 48, 26, 0, 11, 37, 0, 40, 16, 0, 83, 7, 37, 124, 118, 56, 129, 61, 0, 34, 21, 101, 36, 70, 36, 0, 72, 0, 0, 112, 132, 77, 193, 150, 192, 241, 178, 190, 198, 222, 142, 255, 215, 224],
[223, 200, 157, 131, 211, 255, 222, 243, 149, 255, 212, 129, 0, 66, 0, 11, 0, 134, 50, 173, 7, 0, 85, 67, 67, 62, 102, 153, 132, 53, 18, 190, 138, 150, 4, 112, 120, 25, 48, 65, 0, 88, 61, 54, 0, 65, 107, 56, 44, 3, 53, 0, 134, 194, 217, 255, 161, 120, 212, 255, 193, 79, 194, 200],
[243, 145, 172, 137, 208, 243, 223, 158, 197, 236, 222, 57, 91, 123, 0, 92, 83, 48, 40, 47, 117, 29, 42, 0, 61, 114, 85, 91, 43, 70, 4, 0, 103, 0, 5, 15, 121, 0, 26, 32, 99, 27, 107, 56, 27, 0, 64, 10, 82, 0, 0, 2, 179, 188, 186, 216, 222, 251, 238, 255, 158, 191, 204, 224],
[184, 79, 188, 241, 133, 190, 200, 233, 243, 137, 106, 0, 47, 66, 75, 0, 77, 33, 144, 0, 60, 132, 45, 16, 0, 67, 4, 70, 90, 32, 88, 148, 81, 73, 47, 0, 58, 83, 0, 103, 32, 40, 34, 31, 0, 67, 56, 78, 58, 5, 11, 0, 140, 226, 159, 250, 195, 208, 195, 225, 172, 190, 255, 231],
[255, 221, 140, 108, 229, 229, 255, 165, 255, 255, 115, 17, 41, 157, 50, 57, 33, 81, 54, 26, 79, 147, 137, 183, 227, 244, 164, 255, 248, 171, 176, 180, 255, 243, 174, 216, 218, 238, 225, 255, 166, 146, 68, 81, 13, 12, 24, 32, 40, 9, 0, 65, 54, 149, 135, 179, 119, 255, 219, 255, 146, 206, 179, 211],
[152, 214, 167, 171, 143, 255, 187, 190, 227, 194, 0, 29, 29, 0, 0, 0, 143, 38, 19, 0, 0, 159, 236, 177, 198, 239, 221, 207, 194, 238, 192, 189, 219, 229, 254, 223, 213, 193, 237, 213, 119, 136, 89, 17, 39, 49, 24, 67, 113, 0, 47, 15, 86, 171, 175, 168, 255, 132, 255, 255, 182, 209, 255, 227],
[144, 164, 107, 184, 179, 200, 239, 248, 214, 0, 158, 68, 0, 34, 43, 82, 40, 20, 51, 90, 62, 169, 255, 255, 255, 160, 217, 179, 179, 167, 181, 255, 255, 208, 207, 244, 181, 255, 208, 216, 181, 249, 185, 77, 60, 0, 80, 19, 64, 84, 94, 82, 113, 13, 122, 104, 228, 175, 207, 255, 255, 206, 184, 123],
[130, 195, 134, 184, 253, 185, 176, 221, 160, 22, 27, 60, 85, 49, 41, 126, 0, 15, 155, 0, 191, 170, 255, 244, 189, 182, 183, 226, 194, 198, 136, 239, 183, 255, 216, 234, 255, 153, 176, 255, 254, 255, 182, 0, 72, 59, 33, 65, 124, 13, 27, 27, 105, 23, 191, 190, 195, 214, 255, 141, 126, 242, 251, 255],
[110, 242, 156, 163, 255, 193, 204, 213, 198, 31, 28, 135, 34, 40, 74, 37, 63, 50, 83, 122, 172, 126, 183, 191, 228, 255, 201, 191, 163, 255, 199, 204, 195, 198, 186, 240, 121, 84, 193, 183, 113, 255, 248, 91, 60, 44, 0, 149, 104, 50, 62, 34, 112, 107, 189, 202, 166, 91, 173, 255, 184, 221, 148, 159],
[199, 189, 209, 119, 224, 140, 216, 126, 130, 71, 115, 62, 80, 79, 16, 69, 97, 36, 119, 0, 172, 52, 207, 204, 141, 211, 255, 176, 166, 218, 241, 228, 138, 217, 211, 250, 153, 224, 141, 255, 241, 195, 183, 162, 21, 70, 3, 53, 0, 113, 50, 5, 94, 56, 41, 195, 125, 255, 87, 232, 206, 156, 182, 241],
[255, 222, 255, 208, 171, 148, 250, 115, 199, 47, 118, 41, 92, 84, 62, 0, 66, 21, 43, 2, 237, 142, 255, 255, 140, 255, 215, 229, 162, 213, 249, 225, 235, 224, 206, 79, 197, 157, 255, 186, 206, 163, 152, 107, 19, 132, 2, 106, 35, 144, 0, 104, 0, 39, 94, 143, 191, 248, 202, 243, 158, 172, 212, 82],
[243, 155, 255, 143, 175, 218, 179, 148, 105, 75, 62, 69, 43, 101, 84, 38, 91, 61, 166, 201, 177, 255, 126, 255, 190, 195, 231, 250, 206, 207, 173, 207, 186, 197, 124, 255, 181, 190, 168, 84, 163, 213, 255, 185, 187, 44, 26, 81, 98, 43, 15, 98, 86, 0, 0, 56, 194, 236, 222, 209, 194, 166, 174, 227],
[135, 216, 255, 242, 82, 223, 188, 168, 236, 65, 139, 155, 253, 146, 163, 255, 189, 255, 236, 201, 205, 238, 255, 177, 172, 226, 229, 171, 231, 206, 231, 208, 101, 142, 170, 214, 245, 176, 252, 216, 225, 205, 255, 255, 177, 255, 255, 248, 255, 255, 181, 209, 199, 234, 121, 220, 137, 205, 255, 103, 112, 147, 225, 176],
[183, 117, 127, 146, 247, 186, 255, 116, 180, 203, 132, 222, 143, 212, 77, 235, 194, 183, 160, 155, 197, 206, 215, 161, 178, 125, 153, 224, 118, 185, 198, 255, 255, 128, 193, 255, 226, 128, 131, 230, 255, 255, 195, 170, 252, 255, 234, 122, 255, 255, 213, 255, 220, 177, 187, 255, 255, 232, 241, 219, 255, 155, 171, 138],
[218, 255, 142, 168, 215, 140, 170, 153, 149, 140, 102, 186, 255, 233, 143, 255, 166, 185, 207, 255, 197, 224, 220, 124, 183, 159, 224, 112, 235, 137, 179, 125, 171, 232, 134, 245, 203, 225, 246, 211, 207, 214, 231, 190, 222, 123, 255, 239, 194, 183, 255, 134, 218, 255, 255, 162, 255, 228, 171, 225, 197, 255, 162, 156],
[146, 240, 131, 230, 163, 213, 253, 255, 153, 221, 179, 221, 233, 245, 183, 159, 136, 242, 255, 211, 216, 214, 140, 188, 155, 217, 186, 224, 179, 183, 208, 240, 223, 154, 164, 255, 255, 19, 169, 191, 139, 159, 204, 69, 216, 255, 177, 227, 153, 219, 235, 237, 92, 238, 255, 255, 255, 255, 121, 111, 220, 254, 208, 255],
[184, 138, 255, 212, 226, 189, 120, 198, 255, 235, 205, 255, 104, 179, 255, 255, 201, 158, 234, 123, 222, 164, 160, 117, 239, 236, 210, 249, 238, 220, 194, 145, 245, 251, 124, 140, 255, 139, 255, 237, 197, 223, 212, 255, 255, 242, 210, 160, 168, 190, 255, 255, 169, 226, 247, 255, 104, 199, 133, 214, 206, 255, 186, 194],
[253, 225, 253, 209, 221, 218, 249, 232, 255, 255, 255, 85, 197, 184, 255, 142, 255, 190, 168, 111, 158, 182, 158, 168, 186, 213, 110, 110, 42, 133, 179, 255, 179, 197, 226, 97, 226, 182, 255, 108, 164, 255, 198, 227, 167, 243, 249, 237, 84, 164, 165, 255, 255, 169, 105, 203, 153, 185, 131, 175, 82, 186, 255, 150],
[234, 207, 230, 242, 222, 158, 255, 247, 172, 179, 138, 178, 162, 255, 221, 213, 159, 235, 224, 197, 255, 204, 140, 219, 254, 209, 178, 237, 255, 255, 200, 208, 206, 231, 81, 255, 170, 255, 201, 175, 83, 255, 197, 176, 220, 255, 196, 201, 165, 197, 197, 121, 206, 157, 171, 227, 159, 150, 174, 166, 160, 224, 199, 203],
[186, 255, 255, 190, 240, 109, 206, 176, 203, 230, 255, 255, 255, 255, 255, 137, 210, 144, 235, 252, 241, 103, 255, 243, 106, 215, 200, 152, 255, 119, 255, 204, 255, 193, 224, 159, 203, 128, 174, 163, 189, 211, 149, 179, 219, 137, 251, 196, 229, 255, 194, 172, 141, 124, 255, 222, 255, 255, 191, 149, 166, 183, 229, 174]])

def helper1(a, b, eps):
    return (a-b)/(math.sqrt(eps**2 + (a-b)**2))

def neighborCost(image, ix, iy, l, eps):
    if ix == 0:
        uxn1 = 0.
    else:
        uxn1 = image[ix-1, iy]

    if iy == 0:
        uyn1 = 0.
    else:
        uyn1 = image[ix, iy-1]
    if ix == 63:
        uxp1 = 0.
    else:
        uxp1 = image[ix+1, iy]

    if iy == 63:
        uyp1 = 0.
    else:
        uyp1 = image[ix, iy+1]

    u = image[ix, iy]
    a1 = helper1(u, uxn1, eps)
    a2 = helper1(u, uxp1, eps)
    b1 = helper1(u, uyn1, eps)
    b2 = helper1(u, uyp1, eps)

    sum = l*(a1 + a2 + b1 + b2)
    return sum

def force(image, orig, ix, iy, l, eps):
    temp = orig[ix,iy] - image[ix,iy] - neighborCost(image, ix, iy, l, eps)
    return temp

def rk2solve(image, imagediff, orig, ix, iy, l, eps, m, dt):
    newimage = np.copy(image)
    k11 = dt*imagediff[ix, iy]
    k12 = dt*(1/m)*(force(image, orig, ix, iy, l, eps) - imagediff[ix,iy])
    k21 = k11 + dt*k12
    newimage[ix, iy] = image[ix,iy] + k11/2.
    k22 = dt*(1/m)*(force(newimage, orig, ix, iy, l, eps) - (imagediff[ix,iy] + k12/2.))
    newpix = image[ix,iy] + k21

    newpixd = imagediff[ix,iy] + k22

    return newpix, newpixd

imgplot1 = plt.imshow(imageInput)
plt.savefig("Original.png")


print("Starting Loop")
for l in [1, 2, 4, 8, 16, 32, 64, 128, 256]:
    imagediff = np.zeros(imageInput.shape)
    imageOutput = np.copy(imageInput)
    oldOutput = np.zeros(imageOutput.shape)
    count = 0
    while (np.linalg.norm(imageOutput - oldOutput) > 0.5) and (count < 200):
        print("Looping")
        oldOutput = np.copy(imageOutput)
        for i in range(0,64):
            for j in range(0,64):
                imageOutput[i,j], imagediff[i,j] = rk2solve(imageOutput, imagediff, imageInput, i,j, l, 1e-2, 0.2, 0.01)
        count = count + 1

    print(f"Tooke {count} iterations.")



    plt.figure()
    imgplot = plt.imshow(imageOutput)
    plt.savefig(f"Smoothed_Lambda{l}.png")
    plt.figure()
    imgplotD = plt.imshow(imagediff)

plt.show()